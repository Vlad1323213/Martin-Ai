# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Gmail –∏ Yandex

## üìã –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

### ‚úÖ **–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
1. **OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** –¥–ª—è Google –∏ Yandex
2. **–†–µ–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Gmail** (—á—Ç–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–∫–∞)
3. **–†–µ–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Google Calendar** (—á—Ç–µ–Ω–∏–µ, —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π)
4. **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—è** (–º–µ—Å—è—á–Ω—ã–π –≤–∏–¥)
5. **–ë–æ–∫–æ–≤–∞—è —à—Ç–æ—Ä–∫–∞** —Å–æ —Å–≤–∞–π–ø–æ–º (–∫–∞–∫ Grok)
6. **–ö–∞—Ä—Ç–æ—á–∫–∏ email –≤ —á–∞—Ç–µ** –æ—Ç AI
7. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤**

---

## üõ† –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–¢–µ–∫—É—â–∏–π `package.json` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
npm install
```

**–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:**
- `next` - Next.js 15
- `react` - React 19
- `@mui/material` - Material UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `@mui/icons-material` - –ò–∫–æ–Ω–∫–∏
- `tailwindcss` - –°—Ç–∏–ª–∏

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è —Ä–∞–±–æ—Ç—ã —Å Gmail/Calendar –Ω–µ –Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ npm –ø–∞–∫–µ—Ç—ã, –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ Fetch API.

---

## üîë –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OAuth

### 2.1 Google OAuth

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ —Ñ–∞–π–ª–µ [`OAUTH_SETUP_GUIDE.md`](./OAUTH_SETUP_GUIDE.md) —Ä–∞–∑–¥–µ–ª "Google OAuth".

**–ö—Ä–∞—Ç–∫–æ:**
1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ OAuth consent screen
3. –°–æ–∑–¥–∞–π—Ç–µ OAuth 2.0 Client ID
4. –í–∫–ª—é—á–∏—Ç–µ Gmail API –∏ Google Calendar API
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ Client ID –∏ Secret

### 2.2 Yandex OAuth

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ —Ñ–∞–π–ª–µ [`OAUTH_SETUP_GUIDE.md`](./OAUTH_SETUP_GUIDE.md) —Ä–∞–∑–¥–µ–ª "Yandex OAuth".

**–ö—Ä–∞—Ç–∫–æ:**
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ [oauth.yandex.ru](https://oauth.yandex.ru/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ—á—Ç–µ –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—é
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –∏ –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## ‚öôÔ∏è –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# Google OAuth
GOOGLE_CLIENT_ID=–≤–∞—à_google_client_id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=–≤–∞—à_google_secret
GOOGLE_REDIRECT_URI=http://localhost:3001/api/auth/google/callback

# Yandex OAuth  
YANDEX_CLIENT_ID=–≤–∞—à_yandex_id
YANDEX_CLIENT_SECRET=–≤–∞—à_yandex_secret
YANDEX_REDIRECT_URI=http://localhost:3001/api/auth/yandex/callback

# NextAuth
NEXTAUTH_SECRET=your_random_secret_here_32_chars_min
NEXTAUTH_URL=http://localhost:3001
```

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è NEXTAUTH_SECRET:**
```bash
openssl rand -base64 32
```

---

## üöÄ –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
npm run dev
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –Ω–∞ `http://localhost:3001`

---

## üì± –®–∞–≥ 5: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É **‚öôÔ∏è Settings** –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
3. –ù–∞–∂–º–∏—Ç–µ **"–ü–æ–¥–∫–ª—é—á–∏—Ç—å Google"** –∏–ª–∏ **"–ü–æ–¥–∫–ª—é—á–∏—Ç—å Yandex"**
4. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—á—Ç–µ –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—é
5. –û–∫–Ω–æ OAuth –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä–æ–µ—Ç—Å—è
6. –°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ ‚úì –ü–æ–¥–∫–ª—é—á–µ–Ω–æ

---

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

### **1. –û—Ç–∫—Ä—ã—Ç—å –±–æ–∫–æ–≤—É—é —à—Ç–æ—Ä–∫—É:**
- **–°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ** —Å –ª–µ–≤–æ–≥–æ –∫—Ä–∞—è —ç–∫—Ä–∞–Ω–∞
- –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ **‚ò∞ Menu** –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É

### **2. –ö–∞–ª–µ–Ω–¥–∞—Ä—å:**
- –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ö–∞–ª–µ–Ω–¥–∞—Ä—å"
- –£–≤–∏–¥–∏—Ç–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–µ—Å—è—á–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- –°–æ–±—ã—Ç–∏—è –æ—Ç–º–µ—á–µ–Ω—ã —Ç–æ—á–∫–∞–º–∏
- –ö–ª–∏–∫ –Ω–∞ –¥–∞—Ç—É –ø–æ–∫–∞–∂–µ—Ç —Å–æ–±—ã—Ç–∏—è

### **3. –ü–æ—á—Ç–∞:**
- –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–ü–æ—á—Ç–∞"
- –£–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Ö–æ–¥—è—â–∏—Ö –ø–∏—Å–µ–º
- –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ –≤—ã–¥–µ–ª–µ–Ω—ã —Å–∏–Ω–µ–π —Ç–æ—á–∫–æ–π
- –ö–ª–∏–∫ –Ω–∞ –ø–∏—Å—å–º–æ –æ—Ç–∫—Ä–æ–µ—Ç –µ–≥–æ (—Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

### **4. AI –∑–∞–ø—Ä–æ—Å—ã –≤ —á–∞—Ç–µ:**
–¢–µ–ø–µ—Ä—å AI –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥:
- "–ü–æ–∫–∞–∂–∏ –º–æ—é –ø–æ—á—Ç—É"
- "–ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è —É –º–µ–Ω—è –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ?"
- "–ï—Å—Ç—å –ª–∏ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞?"

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

### **–§–∞–π–ª—ã OAuth:**
- `lib/oauth.ts` - OAuth helper functions
- `app/api/auth/google/route.ts` - Google OAuth endpoint
- `app/api/auth/google/callback/route.ts` - Google callback
- `app/api/auth/yandex/route.ts` - Yandex OAuth endpoint
- `app/api/auth/yandex/callback/route.ts` - Yandex callback

### **–§–∞–π–ª—ã API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- `lib/gmail.ts` - Gmail API functions
- `lib/google-calendar.ts` - Google Calendar API functions
- `app/api/emails/route.ts` - Email endpoints (—Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)
- `app/api/calendar/route.ts` - Calendar endpoints (—Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)

### **UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `components/SettingsModal.tsx` - –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `components/Calendar.tsx` - –í–∏–∑—É–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- `components/Drawer.tsx` - –ë–æ–∫–æ–≤–∞—è —à—Ç–æ—Ä–∫–∞
- `components/EmailCardInline.tsx` - –ö–∞—Ä—Ç–æ—á–∫–∞ email –¥–ª—è —á–∞—Ç–∞

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

### **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- ‚úÖ –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `localStorage` (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)
- ‚ö†Ô∏è –î–ª—è production –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
  - Backend –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
  - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
  - HTTP-only cookies

### **Rate Limits:**
- Gmail API: 250 –∫–≤–æ—Ç/—Å–µ–∫ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Calendar API: 500 –∫–≤–æ—Ç/—Å–µ–∫ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ - –ø–æ–ª—É—á–∏—Ç–µ 429 –æ—à–∏–±–∫—É

### **–¢–æ–∫–µ–Ω—ã:**
- Access tokens –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 1 —á–∞—Å
- –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å —á–µ—Ä–µ–∑ refresh token
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è refresh token –≤ `lib/oauth.ts`

---

## üìä –ß—Ç–æ –¥–∞–ª—å—à–µ (TODO):

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1:**
- [ ] AI –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–∞—Ä—Å–∏–Ω–≥ –∫–æ–º–∞–Ω–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- [ ] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ email –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ —á–∞—Ç–µ –æ—Ç AI
- [ ] Yandex Mail API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ Gmail)
- [ ] Yandex Calendar API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2:**
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ (Supabase/PostgreSQL)
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ refresh tokens –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å–µ–º —á–µ—Ä–µ–∑ UI
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—è —á–µ—Ä–µ–∑ UI
- [ ] Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –ø–∏—Å—å–º–∞—Ö

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3:**
- [ ] –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π AI (OpenAI/Claude) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –ü–æ–∏—Å–∫ –ø–æ –ø–æ—á—Ç–µ
- [ ] –§–∏–ª—å—Ç—Ä—ã –∏ –º–µ—Ç–∫–∏
- [ ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
- [ ] –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

---

## üêõ Troubleshooting:

### **"Access token required"**
‚Üí –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ Settings

### **"Failed to fetch emails"**
‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Gmail API –≤–∫–ª—é—á–µ–Ω –≤ Google Cloud Console

### **OAuth –æ–∫–Ω–æ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è**
‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ redirect URI —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≤ Google/Yandex

### **"Hydration error"**
‚Üí –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ, –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞:

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [`OAUTH_SETUP_GUIDE.md`](./OAUTH_SETUP_GUIDE.md)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env.local` —Ñ–∞–π–ª
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª —Å `npm run dev` –Ω–∞ –æ—à–∏–±–∫–∏

---

**üéâ –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Gmail –∏ Google Calendar!**




